#Todo

#flow control for if running as service or manually

#try catch for drive mounting

#ENV variables for overlay and lower locations, but otherwise loaded from a file

#set variables before run?

#TODO Separate Upperlayer into snapshotable btrfs subvolume
#snapshot upperlayer, mount snapshot as read only, then copy
#this means I don't have to worry about the upper layer being modified while merging


#have overlay tool create directory to make sure they exist



###Splitting the project into modules

    Copy Script


    Steam Install Tracking

        track shortcuts.vdf
            redirect shortcuts to reboot script


    Execution Control / Service

    Grub entry tracking



FSTAB currently working:

#mounts for lower readonly ntfs bottom layers
UUID=82C425D7C425CDEB /mnt/winOverlay/SSDWinLower ntfs defaults,windows_names,prealloc 0 0
UUID=78DBFD1A57D3E447 /mnt/winOverlay/SSD2WinLower ntfs defaults,windows_names,prealloc 0 0


#overlays
overlay /mnt/SSDWin overlay noauto,x-systemd.automount,defaults,lowerdir=/mnt/winOverlay/SSDWinLower,upperdir=/mnt/winOverlay/SSDWinUpper,workdir=/mnt/winOverlay/SSDWinMerge

overlay /mnt/SSD2Win overlay noauto,x-systemd.automount,defaults,lowerdir=/mnt/winOverlay/SSD2WinLower,upperdir=/mnt/winOverlay/SSD2WinUpper,workdir=/mnt/winOverlay/SSD2WinMerge
these options let the mount work 



Then this command:

sudo mount -a && sudo systemctl daemon-reload && sudo systemctl restart local-fs.target


Is needed to bring the overlays back up

parse config from reading /etc/FSTAB

fix errors by searching lower mount for mistakenly copied whiteout files