source ./breakoutFunction.env

function generateScripts(){
    local params=("$@")
    driveTop=${params[0]}
    driveLow=${params[1]}

    sudo $OVERLAYTOOLSLOCATION/overlay merge -l ${driveLow}/ -u ${driveTop}/
}

function deleteUppers(){
    local params=("$@")
    driveTop=${params[0]}

    sudo rm -rf ${driveTop}/*
}

function processScripts(){
    for file in overlay-tools*.sh; do
    sed -i '/steamapps\/compatdata/d' ./$file
    sed -i '/steamapps\/shadercache/d' ./$file
    sed -i '/steamapps\/temp/d' ./$file

    #split into remove and copy scripts
    #grep 'rm' ./$file > ./$file.remove.sh
    #sed -i 'rm/d' ./$file
    done
}

function compareDiskUsage(){
    local params=("$@")
    driveTop=${params[0]}
    driveLow=${params[1]}

    LowerDiskAvailable=$(df -k $driveLow | tail -1 | awk '{print $4}')
    OverlayDiskUsage=$(du -shk $driveTop | awk '{print $1}')

    if(LowerDiskAvailable <= OverlayDiskUsage); then
        echo "Not enough Space in $driveLow\n"
        echo '-1'
    else
        echo "There is Enough Space in $driveLow\n"
        echo '1'
    fi

}


